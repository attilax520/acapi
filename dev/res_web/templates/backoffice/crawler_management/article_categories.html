<!--
$def with (data=None, data_category_to_sub_category_relation=None, data_sub_category=None, data_last_id=0, order="")
-->
<script src="/backoffice/assets/js/jquery-2.0.3.min.js"></script>
<link rel="stylesheet" href="/backoffice/assets/css/bootstrap.min.css">
<script src="/backoffice/assets/js/bootstrap.min.js"></script>
<link href="/other.css" rel="stylesheet" />
<br>
<div class="row">


 <div class="row">
	<div class="col-md-11">
        <input type="hidden" value="$$order" id="sortvalue">
		<table class="table" style="font-family:微软雅黑;font-size:15px;font-weight:normal; margin: 10px;">
			<thead>
				<tr>
					<th><a href="javascript:listsort('category__x__id');">标示</a><input type="hidden" value="0" id="category__x__id"><span class="glyphicon glyphicon-resize-small" aria-hidden="true" id="category__x__id1"></span></th>
					<th><a href="javascript:listsort('category__x__name');">分类名</a><input type="hidden" value="0" id="category__x__name"><span class="glyphicon glyphicon-resize-small" aria-hidden="true" id="category__x__name1"></span></th>
        <th><a href="javascript:listsort('category__x__index_order');">排序权重</a><input type="hidden" value="0" id="category__x__index_order"><span class="glyphicon glyphicon-resize-small" aria-hidden="true" id="category__x__index_order1"></span></th>
        <th><a href="javascript:listsort('category__x__status');">状态</a><input type="hidden" value="0" id="category__x__status"><span class="glyphicon glyphicon-resize-small" aria-hidden="true" id="category__x__status1"></span></th>
        <th><a href="javascript:listsort('category__x__sub_category');">扩展分类</a><input type="hidden" value="0" id="category__x__sub_category"><span class="glyphicon glyphicon-resize-small" aria-hidden="true" id="category__x__sub_category1"></span></th>
        
					<th colspan="2" style="white-space: nowrap;text-align: center;">操作</th>
				</tr>

			</thead>
			<tbody>
                <tr>
                        <form method="POST">
                            <td style="vertical-align: middle"><input type="text" name="name" class="form-control"  value=$data_last_id readonly></td>
                            <td style="vertical-align: middle"><input type="text" name="name" class="form-control"  value=></td>
                            <td style="vertical-align: middle"><input type="number" name="index_order" class="form-control"  value=1></td>
                            <td><select class="form-control" id="status" name="status"><option value=1>有效</option><option value=2>失败</option></select></td>
<td style="vertical-align: middle">
                                                                $for id,v in data_sub_category.items():
                                                                    <input type="checkbox" name="sub_category_$id" value="$id">$v.name</input>
                            </td>
                            
                            <td colspan=2>
                                    <center>
                                    <input type="hidden" name="action" value="create">
                                    <input type="submit" value="创建" name="" class="btn btn-success">
                            </td>
                        </form>
                    </tr>

            $if data:
                $for item in data:
                    <tr>
                        <form method="POST" style="white-space:nowrap; page-break-inside: avoid;DISPLAY:inline;" name="listrow" id="listrow">
                            <td style="vertical-align: middle">$item.id</td>
                            <td style="vertical-align: middle"><input type="text" name="name" class="form-control"  value="$item.name" ></td>
                            <td style="vertical-align: middle"><input type="number" name="index_order" class="form-control"  value="$item.index_order" step='any'></td>
                            <td style="vertical-align: middle"><select class="form-control" id="status_$loop.index" name="status"><option value=1>有效</option><option value=2>失败</option></select><script>document.getElementById("status_$loop.index").value = $item.status</script></td>
                            <td style="vertical-align: middle">
                                                                $for id,v in data_sub_category.items():
                                                                    $ checked=""
                                                                    $for _, item_relation in data_category_to_sub_category_relation.items():
                                                                        $if item_relation["category_id"] == item.id and item_relation["sub_category_id"] == id:
                                                                            $ checked="checked"
                                                                            $break
                                                                    <input type="checkbox" name="sub_category_$id" value="$id" $checked>$v.name</input>
                            </td>

                            <td colspan=2 style="white-space: nowrap;" >                                
                                <center>
                                    <div style="display:inline-block">
                                        <input type="hidden" name="id" value="$item.id">
                                        <button type="submit" name="action" value="save" class="btn btn-success">保存</button>
                                        <button type="submit" name="action" value="delete"class="btn btn-danger">删除</button>
                                    </div>
                                </center>
                            <td>
                            </td>
                            </form>
                    </tr>
			</tbody>
		</table>
	</div>
<div>

<br>

<script src="/backoffice/assets/js/table_sort.js"></script>
